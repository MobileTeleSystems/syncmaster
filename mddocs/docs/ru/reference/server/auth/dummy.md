# Фиктивный провайдер аутентификации { #server-auth-dummy }

## Описание { #server-auth-dummy-description }

Этот провайдер аутентификации позволяет войти в систему с любым именем пользователя и паролем, а затем выдаёт токен доступа.

После успешной аутентификации имя пользователя сохраняется в базе данных сервера.

## Схема взаимодействия { #server-auth-dummy-interaction-shema}

```plantuml

        @startuml
            title Фиктивный провайдер аутентификации 
            participant "Клиент"
            participant "Сервер"

            == POST v1/auth/token ==

            activate "Клиент"
            alt Успешный случай
                "Клиент" -> "Сервер" ++ : логин + пароль
                "Сервер" --> "Сервер" : Пароль полностью игнорируется
                "Сервер" --> "Сервер" : Проверить пользователя во внутренней базе данных сервера
                "Сервер" -> "Сервер" : Создать пользователя, если он не существует 
                "Сервер" -[#green]> "Клиент" -- : Сгенерировать и вернуть access_token

            else Пользователь блокирован
                "Клиент" -> "Сервер" ++ : логин + пароль
                "Сервер" --> "Сервер" : Пароль полностью игнорируется
                "Сервер" --> "Сервер" : Проверить пользователя во внутренней базе данных сервера
                "Сервер" x-[#red]> "Клиент" -- : 401 Не авторизован

            else Пользователь удален
                "Клиент" -> "Сервер" ++ : логин + пароль
                "Сервер" --> "Сервер" : Проверить пользователя во внутренней базе данных сервера
                "Сервер" --> "Сервер" : Check user in internal server database
                "Сервер" x-[#red]> "Клиент" -- : 404 Не найден
            end

            == GET v1/users/me ==

            alt Успешный случай
                "Клиент" -> "Сервер" ++ : токен доступа
                "Сервер" --> "Сервер" : Валидация токена
                "Сервер" --> "Сервер" : Проверить пользователя во внутренней базе данных сервера
                "Сервер" -> "Сервер" : Предоставить данные
                "Сервер" -[#green]> "Клиент" -- : Вернуть данные

            else Срок действия токена истек
                "Клиент" -> "Сервер" ++ : токен доступа
                "Сервер" --> "Сервер" : Валидация токена
                "Сервер" x-[#red]> "Клиент" -- : 401 не авторизован

            else Пользователь блокирован
                "Клиент" -> "Сервер" ++ : токен доступа
                "Сервер" --> "Сервер" : Валидация токена
                "Сервер" --> "Сервер" : Проверить пользователя во внутренней базе данных сервера
                "Сервер" x-[#red]> "Клиент" -- : 401 не авторизован

            else Пользователь удален
                "Клиент" -> "Сервер" ++ : токен доступа
                "Сервер" --> "Сервер" : Валидация токена
                "Сервер" --> "Сервер" : Проверить пользователя во внутренней базе данных сервера
                "Сервер" x-[#red]> "Клиент" -- : 404 не найден
            end

            deactivate "Клиент"
        @enduml
```

```mermaid
sequenceDiagram
participant "Клиент"
participant "Сервер"
activate "Клиент"
alt Успешный случай
"Клиент" ->> "Сервер" : логин + пароль
"Сервер" ->> "Сервер" : Пароль полностью игнорируется
"Сервер" ->> "Сервер" : Проверить пользователя во внутренней базе данных сервера
"Сервер" ->> "Сервер" : Создать пользователя, если он не существует
else
"Клиент" ->> "Сервер" : логин + пароль
"Сервер" ->> "Сервер" : Пароль полностью игнорируется
"Сервер" ->> "Сервер" : Проверить пользователя во внутренней базе данных сервера
else
"Клиент" ->> "Сервер"  : логин + пароль
"Сервер" ->> "Сервер" : Проверить пользователя во внутренней базе данных сервера
"Сервер" ->> "Сервер" : Check user in internal server database
end
alt Успешный случай
"Клиент" ->> "Сервер" : токен доступа
"Сервер" ->> "Сервер" : Валидация токена
"Сервер" ->> "Сервер" : Проверить пользователя во внутренней базе данных сервера
"Сервер" ->> "Сервер" : Предоставить данные
else
"Клиент" ->> "Сервер" : токен доступа
"Сервер" ->> "Сервер" : Валидация токена
else
"Клиент" ->> "Сервер" : токен доступа
"Сервер" ->> "Сервер" : Валидация токена
"Сервер" ->> "Сервер" : Проверить пользователя во внутренней базе данных сервера
else
"Клиент" ->> "Сервер" : токен доступа
"Сервер" ->> "Сервер" : Валидация токена
"Сервер" ->> "Сервер" : Проверить пользователя во внутренней базе данных сервера
end
deactivate "Клиент"
```

## Конфигурация { #server-auth-dummy-configuration }

::: syncmaster.server.settings.auth.dummy.DummyAuthProviderSettings

::: syncmaster.server.settings.auth.jwt.JWTSettings
